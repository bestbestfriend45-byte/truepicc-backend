<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Truepicc — Проверка фото {{ short_id }}</title>
<style>
:root { --bg:#0b1220; --card:#111827; --text:#e5f2ff; --muted:#9fb3c8; --accent:#10b981; --qr-size:128px; }
*{box-sizing:border-box}
body{margin:0;background:linear-gradient(180deg,#0b1220,#0e1a2e);color:var(--text);font:16px/1.5 system-ui,Segoe UI,Roboto,Arial}
.container{max-width:980px;margin:24px auto;padding:0 16px}
.header{display:flex;align-items:center;gap:12px;margin:8px 0 20px}
.badge{background:#0ea5e9;color:white;padding:4px 10px;border-radius:999px;font-weight:600}
.card{background:var(--card);border:1px solid rgba(255,255,255,.08);border-radius:16px;padding:16px;box-shadow:0 8px 30px rgba(0,0,0,.25)}
.grid{display:grid;grid-template-columns:1.15fr 0.85fr;gap:18px}
@media(max-width:920px){ .grid{grid-template-columns:1fr; } }

.photo img{width:100%;height:auto;border-radius:12px;display:block}

.map-wrap{margin-top:16px;overflow:hidden;border-radius:12px;border:1px solid rgba(255,255,255,.08)}
/* Увеличиваем карту на 30% на десктопе */
.map-scale{transform:scale(1.3); transform-origin: top left; width: 100%; }
.map-viewport{width:600px;height:420px} /* базовый размер; после scale получится ~780546 */
.map-iframe{width:600px;height:420px;border:0;display:block}
@media(max-width:780px){
  .map-scale{transform:none;}
  .map-viewport,.map-iframe{width:100%;height:56vw;max-height:420px}
}

.meta{display:grid;gap:10px;margin-top:8px}
.meta .row{display:flex;gap:10px;align-items:center}
.meta .label{color:var(--muted);min-width:140px}
.link a{color:#60a5fa;text-decoration:none}
.link a:hover{text-decoration:underline}

/* QR код  уменьшаем вдвое и ставим ПОД картой */
.qr{margin-top:16px;text-align:center}
.qr img{width:var(--qr-size);height:auto;image-rendering:pixelated;filter:drop-shadow(0 2px 8px rgba(0,0,0,.35))}
.note{font-size:13px;color:var(--muted);margin-top:8px}

.btns{display:flex;gap:10px;margin-top:12px;flex-wrap:wrap}
.btn{background:#1f2937;border:1px solid rgba(255,255,255,.1);color:#e5f2ff;padding:8px 12px;border-radius:10px;text-decoration:none}
.btn:hover{border-color:#60a5fa}
</style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="badge">Truepicc  проверка</div>
    </div>

    <div class="grid">
      <div class="card">
        <div class="photo">
          <img src="{{ image_url }}" alt="Загруженное фото">
        </div>

        <div class="map-wrap">
          <div class="map-scale">
            <div class="map-viewport">
              <iframe
                class="map-iframe"
                loading="lazy"
                referrerpolicy="no-referrer-when-downgrade"
                src="https://www.google.com/maps?q={{ lat }},{{ lon }}&z=16&output=embed">
              </iframe>
            </div>
          </div>
        </div>

        <div class="qr">
          <img src="{{ qr_data_url or qr_url }}" alt="QR-код ссылки проверки">
          <div class="note">Сканируйте для открытия этой страницы на другом устройстве</div>
        </div>
      </div>

      <div class="card">
        <div class="meta">
          <div class="row"><div class="label">UTC-время:</div><div>{{ taken_at_utc }}</div></div>
          <div class="row"><div class="label">Местное время:</div><div>{{ taken_at_local }} ({{ tz_display }})</div></div>
          <div class="row"><div class="label">Координаты:</div>
            <div class="link">
              <a href="https://maps.google.com/?q={{ lat }},{{ lon }}" target="_blank" rel="noopener">
                {{ lat }}, {{ lon }}
              </a>
            </div>
          </div>
          <div class="row"><div class="label">ID:</div><div>{{ short_id or upload_id }}</div></div>
        </div>

        <div class="btns">
          <a class="btn" href="{{ verify_url }}" target="_blank" rel="noopener">Открыть страницу проверки</a>
          <a class="btn" href="{{ image_url }}" target="_blank" rel="noopener">Открыть изображение</a>
          <a class="btn" href="#" onclick="navigator.clipboard.writeText('{{ verify_url }}'); this.textContent='Ссылка скопирована'; return false;">Скопировать ссылку</a>
        </div>
      </div>
    </div>

  </div>
</body>
</html>
