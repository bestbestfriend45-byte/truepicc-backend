<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Truepicc — Редактирование</title>
<style>
:root { --bg:#0b1220; --card:#111827; --text:#e5f2ff; --muted:#9fb3c8; }
*{box-sizing:border-box}
body{margin:0;background:#0b1220;color:var(--text);font:16px/1.5 system-ui,Segoe UI,Roboto,Arial}
.container{max-width:920px;margin:24px auto;padding:0 16px}
.card{background:var(--card);border:1px solid rgba(255,255,255,.08);border-radius:16px;padding:16px;box-shadow:0 8px 30px rgba(0,0,0,.25);margin-bottom:18px}
.h1{font-size:20px;font-weight:700;margin-bottom:12px}

/* Превью 1280x720 с cover */
.photo-viewport{width:100%;max-width:1280px;aspect-ratio:16/9;margin:0 auto 12px;border-radius:12px;overflow:hidden;border:1px solid rgba(255,255,255,.08)}
.photo-viewport img{width:100%;height:100%;object-fit:cover;display:block}

.form{display:grid;gap:12px}
.row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
label{min-width:160px;color:var(--muted)}
input[type="text"], input[type="datetime-local"]{background:#0f172a;color:var(--text);border:1px solid rgba(255,255,255,.12);border-radius:8px;padding:8px 10px;min-width:260px}
.btns{display:flex;gap:10px;margin-top:12px;flex-wrap:wrap}
button, .btn{background:#1f2937;border:1px solid rgba(255,255,255,.1);color:#e5f2ff;padding:8px 12px;border-radius:10px;text-decoration:none;cursor:pointer}
button:hover,.btn:hover{border-color:#60a5fa}
.note{font-size:13px;color:var(--muted)}
</style>
</head>
<body>
<div class="container">

  <div class="card">
    <div class="h1">Редактирование записи</div>

    {% set sid = short_id or (row.short_id if row is defined else None) or (item.short_id if item is defined else None) %}
    {% set preview_url = image_url or ('/files/web/' ~ sid ~ '.jpg') %}

    <div class="photo-viewport">
      <img src="{{ preview_url }}" alt="Фото {{ sid }}">
    </div>

    <form class="form" method="post">
      <div class="row">
        <label for="taken_at">Время (UTC):</label>
        <input id="taken_at" name="taken_at" type="datetime-local" value="{{ taken_at_value }}">
      </div>
      <div class="row">
        <label for="lat">Широта (lat):</label>
        <input id="lat" name="lat" type="text" value="{{ lat }}">
      </div>
      <div class="row">
        <label for="lon">Долгота (lon):</label>
        <input id="lon" name="lon" type="text" value="{{ lon }}">
      </div>

      <div class="btns">
        <button type="submit">Сохранить</button>
        <a class="btn" href="{{ verify_url }}" target="_blank" rel="noopener">Открыть страницу проверки</a>
      </div>
      <div class="note">После сохранения обновите страницу проверки (Ctrl/+R).</div>
    </form>
  </div>

</div>
</body>
</html>
